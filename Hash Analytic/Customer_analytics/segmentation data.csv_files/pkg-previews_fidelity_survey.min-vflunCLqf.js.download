define("modules/clean/react/previews/fidelity_survey/constants",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OTHER_RESPONSE_ID=t.DismissalMethod=t.InitialResponseId=t.QuestionId=void 0,(function(e){e.Initial="initial",e.NegativeFollowup="negative_followup",e.PositiveFollowup="positive_followup"})(t.QuestionId||(t.QuestionId={})),(function(e){e.VeryDissatisfied="initial_very_dissatisfied",e.Dissatisfied="initial_dissatisfied",e.Neutral="initial_neutral",e.Satisfied="initial_satisfied",e.VerySatisfied="initial_very_satisfied"})(t.InitialResponseId||(t.InitialResponseId={})),(function(e){e.CancelClick="cancel",e.OverlayClick="overlay"})(t.DismissalMethod||(t.DismissalMethod={})),t.OTHER_RESPONSE_ID="other"})),define("modules/clean/react/previews/fidelity_survey/fidelity_survey_bar",["require","exports","tslib","classnames","modules/clean/react/previews/fidelity_survey/strings","modules/clean/react/previews/fidelity_survey/constants","modules/clean/react/previews/fidelity_survey/utils","modules/clean/static_urls","modules/core/i18n","react","spectrum/button/index","spectrum/tooltip/index"],(function(e,t,s,i,a,o,n,l,r,d,u,c){"use strict";var f;Object.defineProperty(t,"__esModule",{value:!0}),t.FidelitySurveyBar=void 0,i=s.__importDefault(i),d=s.__importStar(d);var p=function(e){return l.static_url("/static/images/fidelity_survey/"+e)},m=((f={})[o.InitialResponseId.VeryDissatisfied]=p("very_dissatisfied.png"),f[o.InitialResponseId.Dissatisfied]=p("dissatisfied.png"),f[o.InitialResponseId.Neutral]=p("neutral.png"),f[o.InitialResponseId.Satisfied]=p("satisfied.png"),f[o.InitialResponseId.VerySatisfied]=p("very_satisfied.png"),f),v=function(e){var t=e.isSelected,s=void 0!==t&&t,o=e.onClick,n=e.responseId;return d.createElement("div",{className:i.default("fidelity-survey-bar__option",{"fidelity-survey-bar__option--selected":s})},d.createElement(c.Tooltip,{tooltipContent:a.INITIAL_RESPONSES[n]},d.createElement(u.Button,{variant:"styleless",className:"fidelity-survey-bar__option-button",onClick:o},d.createElement("img",{className:"fidelity-survey-bar__option-button-img",src:m[n],alt:a.INITIAL_RESPONSES[n]}))))};t.FidelitySurveyBar=function(e){var t=e.onDismiss,s=e.onSubmit,i=e.selectedResponse;return e.open?d.createElement("div",{className:"fidelity-survey-bar"},a.QUESTIONS[o.QuestionId.Initial],d.createElement("div",{className:"fidelity-survey-bar__response-buttons"},Object.keys(a.INITIAL_RESPONSES).map((function(e){return d.createElement(v,{key:e,responseId:e,isSelected:i===e,onClick:function(){var t;return s({order:n.idListToOrderMap(Object.keys(a.INITIAL_RESPONSES)),values:(t={},t[e]="checked",t)})}})}))),d.createElement(u.Button,{className:"fidelity-survey-bar__close-button",variant:"styleless",onClick:t},r.intl.formatMessage({id:"BMQUdK",defaultMessage:"Close"}))):null}})),define("modules/clean/react/previews/fidelity_survey/fidelity_survey_component",["require","exports","tslib","modules/clean/file_store/utils","modules/clean/loggers/file_preview_logger","modules/clean/react/css","modules/clean/react/file_viewer/constants","modules/clean/react/file_viewer/file_preview_event_emitter","modules/clean/react/file_viewer/models","modules/clean/react/previews/fidelity_survey/constants","modules/clean/react/previews/fidelity_survey/fidelity_survey_bar","modules/clean/react/previews/fidelity_survey/fidelity_survey_modal","modules/clean/react/previews/fidelity_survey/utils","modules/clean/react/snackbar","modules/core/i18n","react"],(function(e,t,s,i,a,o,n,l,r,d,u,c,f,p,m,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FidelitySurvey=t.FidelitySurveyWithoutCSS=void 0,v=s.__importDefault(v);var y={thankYou:m.intl.formatMessage({id:"BOLnxx",defaultMessage:"Thanks. Your feedback will help improve Dropbox."})};function _(e,t){var s=r.FilePreviewSession.currentSession;l.filePreviewEventEmitter.emit(e,s,t)}var g=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isBarOpen:!0,isModalOpen:!1},t.onBarSubmit=function(e){_(n.EventType.FilePreviewFidelitySurveyAnswered,s.__assign(s.__assign({},e),{question_id:d.QuestionId.Initial}));var i=Object.keys(e.values)[0],a=f.getFollowupQuestionId(i),o=f.getFollowupResponses(a,t.props.file);o?t.setState({barSubmission:e,followUpQuestionId:a,followUpResponses:o,isModalOpen:!0}):(t.closeBarAndModal(),p.Snackbar.complete(y.thankYou,"fidelity-survey"))},t.onBarDismiss=function(){_(n.EventType.FilePreviewFidelitySurveyDismissed,{question_id:d.QuestionId.Initial}),t.closeBarAndModal()},t.handleModalSubmit=function(e,i){if(t.state.followUpQuestionId){var a=t.props.file,o=t.props.allowFileDonation&&i?{_file_nsid:a.ns_id,_file_sjid:a.sjid}:{};_(n.EventType.FilePreviewFidelitySurveyAnswered,s.__assign(s.__assign({question_id:t.state.followUpQuestionId},e),o))}t.closeBarAndModal(),p.Snackbar.complete(y.thankYou,"fidelity-survey")},t.handleModalDismiss=function(e){t.state.followUpQuestionId&&_(n.EventType.FilePreviewFidelitySurveyDismissed,{question_id:t.state.followUpQuestionId,dismissal_method:e}),t.closeBarAndModal()},t}return s.__extends(t,e),t.prototype.componentDidMount=function(){this.logger=new a.FilePreviewFidelitySurveyLogger,this.logger.listenTo(l.filePreviewEventEmitter),_(n.EventType.FilePreviewFidelitySurveyAsked)},t.prototype.componentWillUnmount=function(){this.logger.unlistenTo(l.filePreviewEventEmitter)},t.prototype.closeBarAndModal=function(){this.setState({isBarOpen:!1,isModalOpen:!1})},t.prototype.render=function(){var e,t=this.props,s=t.allowFileDonation,a=t.file,o=this.state,n=o.barSubmission,l=o.followUpQuestionId,r=o.followUpResponses,d=o.isBarOpen,f=o.isModalOpen;return n&&(e=Object.keys(n.values)[0]),v.default.createElement("div",null,v.default.createElement(u.FidelitySurveyBar,{onSubmit:this.onBarSubmit,onDismiss:this.onBarDismiss,selectedResponse:e,open:d}),v.default.createElement(c.FidelitySurveyModal,{allowFileDonation:s,filename:i.getFilename(a),onDismiss:this.handleModalDismiss,onSubmit:this.handleModalSubmit,questionId:l,responses:r,open:f}))},t})(v.default.Component);t.FidelitySurveyWithoutCSS=g;var h=o.requireCssWithComponent(g,["/static/css/fidelity_survey/fidelity_survey-vflBSc-LN.css"]);t.FidelitySurvey=h})),define("modules/clean/react/previews/fidelity_survey/fidelity_survey_modal",["require","exports","tslib","lodash","modules/clean/react/previews/fidelity_survey/constants","modules/clean/react/previews/fidelity_survey/fidelity_survey_modal_form","modules/clean/react/previews/fidelity_survey/strings","modules/clean/react/previews/fidelity_survey/utils","modules/core/i18n","react","spectrum/modal/utility_modal"],(function(e,t,s,i,a,o,n,l,r,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FidelitySurveyModal=void 0,i=s.__importStar(i),d=s.__importDefault(d);var c={modalTitle:r.intl.formatMessage({id:"YTQf/k",defaultMessage:"Thank you for the feedback"}),otherSurveyResponseLabel:r.intl.formatMessage({id:"zCVuen",defaultMessage:"Other"}),cancelSurveyButton:r.intl.formatMessage({id:"OExDRE",defaultMessage:"Cancel"}),submitSurveyButton:r.intl.formatMessage({id:"Lb9moY",defaultMessage:"Submit"}),modalAriaLabel:r.intl.formatMessage({id:"J4Iou5",defaultMessage:"Preview Feedback Survey"})};var f=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isFileDonationChecked:!1,otherResponse:{checked:!1,message:c.otherSurveyResponseLabel,value:""},responseMap:{}},t.handleResponseChange=function(e,i,o){var n;e===a.OTHER_RESPONSE_ID?t.handleOtherResponseChange(i,o):t.setState({responseMap:s.__assign(s.__assign({},t.state.responseMap),(n={},n[e]=s.__assign(s.__assign({},t.state.responseMap[e]),{checked:i}),n))})},t.handleFileDonationChange=function(e){t.setState({isFileDonationChecked:e})},t.handlePrimaryAction=function(){var e=Object.keys(t.state.responseMap),s={order:l.idListToOrderMap(e),values:{}};e.forEach((function(e){t.state.responseMap[e].checked&&(s.values[e]="checked")})),t.state.otherResponse.checked&&t.state.otherResponse.value&&(s.values[a.OTHER_RESPONSE_ID]=t.state.otherResponse.value),t.props.onSubmit(s,t.state.isFileDonationChecked)},t.handleSecondaryAction=function(){t.props.onDismiss(a.DismissalMethod.CancelClick)},t.handleRequestClose=function(){t.props.onDismiss(a.DismissalMethod.OverlayClick)},t}return s.__extends(t,e),t.prototype.componentWillReceiveProps=function(e){var t,s;e.responses&&e.responses!==this.props.responses&&this.setState({responseMap:(t=e.responses,s={},i.shuffle(Object.keys(t)).forEach((function(e){s[e]={message:t[e],checked:!1}})),s)})},t.prototype.handleOtherResponseChange=function(e,t){var i=s.__assign(s.__assign({},this.state.otherResponse),{checked:e});void 0!==t&&(i.value=t),i.value!==this.state.otherResponse.value&&(i.checked?""===i.value&&(i.checked=!1):i.checked=!0),this.setState({otherResponse:i})},t.prototype.render=function(){var e=this.props.allowFileDonation&&this.props.questionId===a.QuestionId.NegativeFollowup,t=this.props,s=t.filename,i=t.open,l=t.questionId,r=this.state,f=r.isFileDonationChecked,p=r.otherResponse,m=r.responseMap;return d.default.createElement(u.UtilityModal,{appElement:document.querySelector(".react-file-viewer"),ariaLabel:c.modalAriaLabel,onPrimaryAction:this.handlePrimaryAction,onRequestClose:this.handleRequestClose,onSecondaryAction:this.handleSecondaryAction,open:i,overlayClassName:"file-viewer-modal-overlay",overlayClickClose:!0,primaryAction:c.submitSurveyButton,secondaryAction:c.cancelSurveyButton,shouldRequestCloseOnActions:!1,title:l?n.QUESTIONS[l]:""},d.default.createElement(o.FidelitySurveyModalForm,{allowFileDonation:e,filename:s,isFileDonationChecked:f,onFileDonationChange:this.handleFileDonationChange,onResponseChange:this.handleResponseChange,otherResponse:p,responses:m}))},t})(d.default.Component);t.FidelitySurveyModal=f})),define("modules/clean/react/previews/fidelity_survey/fidelity_survey_modal_form",["require","exports","tslib","modules/clean/em_string","modules/clean/filepath","modules/clean/react/previews/fidelity_survey/constants","modules/core/i18n","react","spectrum/checkbox/index","spectrum/file_icon/index","spectrum/input/index"],(function(e,t,s,i,a,o,n,l,r,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FidelitySurveyModalForm=t.FileDonation=t.ResponseList=void 0,a=s.__importStar(a),l=s.__importDefault(l);var c={disclaimer:n.intl.formatMessage({id:"L0PeUM",defaultMessage:"The Dropbox team will review your document. It will only be used to help improve previews."}),formQuestion:n.intl.formatMessage({id:"+jtPQr",defaultMessage:"Please select all that apply."})};t.ResponseList=function(e){var t=e.responses,s=e.onResponseChange,i=e.otherResponse;return l.default.createElement("ul",{className:"fidelity-survey-modal-form__responses"},Object.keys(t).map((function(e){var i=t[e],a=i.checked,o=i.message,n=a?"checked":"unchecked";return l.default.createElement("li",{key:e,className:"fidelity-survey-modal-form__response"},l.default.createElement(r.Checkbox,{id:e,checked:n,onChange:function(t){return s(e,"checked"===t)}}),l.default.createElement("label",{htmlFor:e,className:"fidelity-survey-modal-form__response-label"},o))})),l.default.createElement("li",{className:"fidelity-survey-modal-form__response"},l.default.createElement(r.Checkbox,{id:o.OTHER_RESPONSE_ID,checked:i.checked?"checked":"unchecked",onChange:function(e){return s(o.OTHER_RESPONSE_ID,"checked"===e)}}),l.default.createElement("label",{htmlFor:o.OTHER_RESPONSE_ID,className:"fidelity-survey-modal-form__response-label"},l.default.createElement(u.Input,{className:"fidelity-survey-modal-form__input",placeholder:i.message,value:i.value,onClick:function(e){e.preventDefault()},onChange:function(e){return s(o.OTHER_RESPONSE_ID,i.checked,e.currentTarget.value)}}))))},t.FileDonation=function(e){var t=e.isFileDonationChecked,s=e.onFileDonationChange,o=e.filename;return l.default.createElement("label",{className:"fidelity-survey-modal-form__donation",htmlFor:"file-donation"},l.default.createElement(r.Checkbox,{id:"file-donation",checked:t?"checked":"unchecked",onChange:function(e){return s("checked"===e)}}),l.default.createElement(d.FileIcon,{className:"fidelity-survey-modal-form__donation-icon",path:o}),l.default.createElement("div",{className:"fidelity-survey-modal-form__donation-meta"},l.default.createElement("p",{className:"fidelity-survey-modal-form__donation-name"},n.intl.formatMessage({id:"FLLfhH",defaultMessage:"Include <b>{filename}</b>"},{filename:i.Emstring.em_snippet(a.filename(o),32),b:function(e){return l.default.createElement("b",null,e)}})),l.default.createElement("p",{className:"fidelity-survey-modal-form__donation-disclaimer"},c.disclaimer)))},t.FidelitySurveyModalForm=function(e){return l.default.createElement("div",{className:"fidelity-survey-modal-form"},l.default.createElement("p",{className:"fidelity-survey-modal-form__question"},c.formQuestion),l.default.createElement(t.ResponseList,s.__assign({},e)),e.allowFileDonation&&l.default.createElement(t.FileDonation,s.__assign({},e)))}})),define("modules/clean/react/previews/fidelity_survey/strings",["require","exports","tslib","modules/clean/react/previews/fidelity_survey/constants","modules/core/i18n"],(function(e,t,s,i,a){"use strict";var o,n;Object.defineProperty(t,"__esModule",{value:!0}),t.NegativeFollowupResponsesByExtension=t.PositiveFollowupResponses=t.INITIAL_RESPONSES=t.QUESTIONS=void 0;var l=["doc","docx"],r=["ppt","pptx"],d=["epub"];t.QUESTIONS=((o={})[i.QuestionId.Initial]=a.intl.formatMessage({id:"Fwo2By",defaultMessage:"How happy are you with this file preview?"}),o[i.QuestionId.PositiveFollowup]=a.intl.formatMessage({id:"uyXDaM",defaultMessage:"Why are you previewing this file?"}),o[i.QuestionId.NegativeFollowup]=a.intl.formatMessage({id:"BbVXLk",defaultMessage:"Are you encountering any issues with this file preview?"}),o),t.INITIAL_RESPONSES=((n={})[i.InitialResponseId.VeryDissatisfied]=a.intl.formatMessage({id:"FAgdb8",defaultMessage:"Not at all happy"}),n[i.InitialResponseId.Dissatisfied]=a.intl.formatMessage({id:"HVbcWT",defaultMessage:"Not happy"}),n[i.InitialResponseId.Neutral]=a.intl.formatMessage({id:"H2QPye",defaultMessage:"Neutral"}),n[i.InitialResponseId.Satisfied]=a.intl.formatMessage({id:"cOo73s",defaultMessage:"Happy"}),n[i.InitialResponseId.VerySatisfied]=a.intl.formatMessage({id:"aUJ5Hz",defaultMessage:"Very happy"}),n),t.PositiveFollowupResponses={positive_add_comments:a.intl.formatMessage({id:"ZShsIh",defaultMessage:"Make comments"}),positive_collaborate:a.intl.formatMessage({id:"+ZowJr",defaultMessage:"@mention someone on my team"}),positive_correct_file:a.intl.formatMessage({id:"ag9tIb",defaultMessage:"Check if itâ€™s the right file"}),positive_download:a.intl.formatMessage({id:"EFMKS+",defaultMessage:"Download the file"}),positive_present:a.intl.formatMessage({id:"ETp2gK",defaultMessage:"Present work to my team or clients"}),positive_share:a.intl.formatMessage({id:"EwObyT",defaultMessage:"Share the file with others"}),positive_view_content:a.intl.formatMessage({id:"GhTqsZ",defaultMessage:"View the file contents"})};var u,c,f={ppt_colors:a.intl.formatMessage({id:"mlXeFC",defaultMessage:"Colors"}),ppt_scale:a.intl.formatMessage({id:"n7x16A",defaultMessage:"Too zoomed in/out"}),ppt_fonts:a.intl.formatMessage({id:"jRjIMn",defaultMessage:"Fonts"}),ppt_interactives:a.intl.formatMessage({id:"hith0F",defaultMessage:"Videos/Images"}),ppt_layout:a.intl.formatMessage({id:"rnzApw",defaultMessage:"Layout"}),ppt_tables:a.intl.formatMessage({id:"qL/GCx",defaultMessage:"Tables"})},p={word_colors:a.intl.formatMessage({id:"6VnReU",defaultMessage:"Colors"}),word_fonts:a.intl.formatMessage({id:"YetG8G",defaultMessage:"Fonts"}),word_language:a.intl.formatMessage({id:"KysfOz",defaultMessage:"Unreadable Text"}),word_layout:a.intl.formatMessage({id:"n52N16",defaultMessage:"Layout"}),word_line_spacing:a.intl.formatMessage({id:"0W2SPV",defaultMessage:"Spacing between lines"}),word_margin:a.intl.formatMessage({id:"OXWpDh",defaultMessage:"Margins"})},m={epub_colors:a.intl.formatMessage({id:"iWYk2k",defaultMessage:"Colors"}),epub_fonts:a.intl.formatMessage({id:"Jnf299",defaultMessage:"Fonts"}),epub_language:a.intl.formatMessage({id:"nB93ha",defaultMessage:"Unreadable text"}),epub_layout:a.intl.formatMessage({id:"ZfPA5x",defaultMessage:"Layout"}),epub_line_spacing:a.intl.formatMessage({id:"ebmd4b",defaultMessage:"Spacing between lines"}),epub_margin:a.intl.formatMessage({id:"NzS/z7",defaultMessage:"Margins"}),epub_pagination:a.intl.formatMessage({id:"tLSiuw",defaultMessage:"Unexpected pagination"}),epub_images:a.intl.formatMessage({id:"0uq+BA",defaultMessage:"Images"}),epub_tables:a.intl.formatMessage({id:"ESecig",defaultMessage:"Tables"})};t.NegativeFollowupResponsesByExtension=(u={},c=function(e,t){var i;u=s.__assign(s.__assign({},u),((i={})[e]=t,i))},r.forEach((function(e){return c(e,f)})),l.forEach((function(e){return c(e,p)})),d.forEach((function(e){return c(e,m)})),u)})),define("modules/clean/react/previews/fidelity_survey/utils",["require","exports","tslib","modules/clean/file_store/utils","modules/clean/react/previews/fidelity_survey/constants","modules/clean/react/previews/fidelity_survey/strings"],(function(e,t,s,i,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.idListToOrderMap=t.getFollowupResponses=t.getFollowupQuestionId=void 0,t.getFollowupQuestionId=function(e){switch(e){case a.InitialResponseId.VerySatisfied:case a.InitialResponseId.Satisfied:return a.QuestionId.PositiveFollowup;default:return a.QuestionId.NegativeFollowup}},t.getFollowupResponses=function(e,t){var s=i.getExtension(t);switch(e){case a.QuestionId.PositiveFollowup:return o.PositiveFollowupResponses;case a.QuestionId.NegativeFollowup:return o.NegativeFollowupResponsesByExtension[s];default:return}},t.idListToOrderMap=function(e){return e.reduce((function(e,t,i){var a;return s.__assign(s.__assign({},e),((a={})[t]=i,a))}),{})}}));
//# sourceMappingURL=pkg-previews_fidelity_survey.min.js-vflBXR-99.map